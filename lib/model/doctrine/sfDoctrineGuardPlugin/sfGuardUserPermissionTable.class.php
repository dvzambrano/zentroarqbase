<?php

/**
 * sfGuardUserPermissionTable
 * 
 * This class has been auto-generated by the Doctrine ORM Framework
 */
class sfGuardUserPermissionTable extends PluginsfGuardUserPermissionTable {

    /**
     * Returns an instance of this class.
     *
     * @return object sfGuardUserPermissionTable
     */
    public static function getInstance() {
        return Doctrine_Core::getTable('sfGuardUserPermission');
    }

    public static function formatData($array, $page, $count = false) {
        return array(
            'metaData' => array(
                'idProperty' => 'id',
                'root' => 'data',
                'totalProperty' => 'results',
                'fields' => array(
                    array('name' => 'user_id', 'type' => 'int'),
                    array('name' => 'permission_id', 'type' => 'int'),
                    array('name' => 'id', 'type' => 'int'),
                    array('name' => 'name', 'type' => 'string'),
                    array('name' => 'description', 'type' => 'string')
                ),
                'sortInfo' => array(
                    'field' => 'id',
                    'direction' => 'ASC'
                )
            ),
            'success' => true,
            'message' => 'app.msg.info.loadedsuccessful',
            'results' => $count,
            'data' => $array->toArray(),
            'page' => $page
        );
    }

    public static function getAll($filters = array(), $simple = false) {
        $q = Doctrine_Query::create()
                ->from('sfGuardUserPermission cbr');

        if ($query && $query != '')
            $q = Doctrine_Query::create()
                    ->select('cbr.*')
                    ->from('sfGuardUserPermission cbr')
                    ->where('cbr.user_id = ?', $query);

        return self::formatData($q->execute(), 1, $q->count());
    }

}