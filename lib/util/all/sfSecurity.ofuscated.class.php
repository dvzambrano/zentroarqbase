<?php
class sfSecurity { const ENCRYPTION_METHOD = "AES-256-CBC"; const EXPORT_KEY = "\70\x31\60\x39\62\x37\61\x39\61\x30\61\x64\64\x33\65\x76\65\x35\66\x7a"; public static function getServerUniqueINFO() { $unique = ""; $array = array(); if (strtoupper(substr(PHP_OS, 0, 3)) === "\127\x49\116") { exec("wmic DISKDRIVE get SerialNumber", $output); unset($output[0]); foreach($output as $key => $value){ if(trim($value)==""){ unset($output[$key]); continue; } $output[$key] = trim($value); $output[$key] = str_replace("\55", "", $output[$key]); } $array = $output; } else { exec("ls -l /dev/disk/by-id/", $output); foreach ($output as $line) if (preg_match("/(.*)_HARDDISK_(.*)/", $line)) { $unique = explode("\137\x48\101\x52\104\x44\111\x53\113\x5f", $line); $unique = explode("\40", $unique[1]); $array[] = trim($unique[0]); } foreach ($array as $key => $value) if(stripos($value, "\55\x70\141\x72\164")>-1) unset($array[$key]); else $array[$key] = str_replace("\55", "", $value); } $unique = implode("\55", $array); return $unique; } public static function getSystemInstallDate($module = "\144\x62") { $xg = "\147\x7a\151\x6e\146\x6c\141\x74\145"; $xb = "\142\x61\163\x65\66\x34\137\x64\145\x63\157\x64\145"; eval($xg($xb("U6kwTjJOSjZMM0gzN0lKNkozSk1JTjFPNDVNNjezNLA0NlawVVBKTy0Jys8vCUgsyVCyBgA="))); return filemtime(Util::$x3b3bc1f0f74bc2f2edcd7a55c7690933("", true) . DIRECTORY_SEPARATOR . "\141\x70\160\x73" . DIRECTORY_SEPARATOR . "\142\x61\143\x6b\145\x6e\144" . DIRECTORY_SEPARATOR . "\155\x6f\144\x75\154\x65\163" . DIRECTORY_SEPARATOR . $module . DIRECTORY_SEPARATOR . "\141\x63\164\x69\157\x6e\163" . DIRECTORY_SEPARATOR . "\141\x63\164\x69\157\x6e\163\x2e\143\x6c\141\x73\163\x2e\160\x68\160"); } public static function getSystemCheckSum() { $xg = "\147\x7a\151\x6e\146\x6c\141\x74\145"; $xb = "\142\x61\163\x65\66\x34\137\x64\145\x63\157\x64\145"; eval($xg($xb("U6kwTjJOSjZMM0gzN0lKNkozSk1JTjFPNDVNNjezNLA0NlawVVBKTy0Jys8vCUgsyVCyBgA="))); eval($xg($xb("PYyxCoMwFEX3foUEB92SRmNBHNTSQetroZqhZNEigSh0EDTx6/sopcPjcLnnXd9qL/OIYlGibNIrFjNlxYhZIF9IzEmEjEl68O3ws4/YMsUER8ZKoMxR4jgivjKS49g/4/O49nPgW403BKQT09aa6vYwz6ahegc61zC998fEqtZc7nCWAGbc4ZpTmPtNyqJuHa3cclrLTi9Olq7QeUbCMEw/"))); eval($xg($xb("DcNfc0MwAADw79LbQz3FJqdyexqL1hD/r5U3Mg0uaDDUp19/d79qKcTxbeOv5fEQ5s/NGvzVxjftPmTYRB9J3BHzQtIkquZxoLKmBDc8qVX8nW46mIYHC1vm9f3tF0kPBE4uzk1JnNFuidjymjo2cnbc4RYL3Qi0dYIg96cMxwZ1B3+LYcubpXUTiDiAIICoD/kVqprpRqmKikJf8nXXi7riTH/fLYSMO5YzZafeun6dSwbpI+3CmTzlz9+l0BgTo5c2KBDyFFVZafl4BQdFUT7/AQ=="))); eval($xg($xb("DcrJcoIwAADQf3F6qOMBEBAzHQ/ESGVT0UCJNwlLIwSIlUW+vh7e7WX9rfr8GIu35HOG6CGnsj+YJhoM4CXBpFqOSF/ZKDzlF0kPPVT9Qu5uCIWtAqTUAMKleEyyY6/nu0D/kw7f/RSN9/x54picIXBUuJ+Cp12K7jo2nsshomsRxev6R1txm+y3Ss9Brj4tuTzBndZNpeLUB6tj6f3F782S1gnVzsRTAyanxC7AivrjcFWguvAI7ZI2DjFDzLTtbYOkMhLtoz0L7rLSydd1HDPjwfBeyj1y8Y86ma63POvqVXoZktZeqFuOp2oCi0qGBW50unQhellW9G6VBoPUCrEhmcFmM5vP51//"))); $tochecksum = array( Util::$x3b3bc1f0f74bc2f2edcd7a55c7690933("", true) . DIRECTORY_SEPARATOR . "\141\x70\160\x73" . DIRECTORY_SEPARATOR . "\142\x61\143\x6b\145\x6e\144" . DIRECTORY_SEPARATOR . "\155\x6f\144\x75\154\x65\163" . DIRECTORY_SEPARATOR . "\144\x62" . DIRECTORY_SEPARATOR . "\141\x63\164\x69\157\x6e\163" . DIRECTORY_SEPARATOR . "\141\x63\164\x69\157\x6e\163\x2e\143\x6c\141\x73\163\x2e\160\x68\160", Util::$x3b3bc1f0f74bc2f2edcd7a55c7690933("", true) . DIRECTORY_SEPARATOR . "\154\x69\142" . DIRECTORY_SEPARATOR . "\165\x74\151\x6c" . DIRECTORY_SEPARATOR . "\163\x66\123\x65\143\x75\162\x69\164\x79\56\x63\154\x61\163\x73", Util::$x3b3bc1f0f74bc2f2edcd7a55c7690933("", true) . DIRECTORY_SEPARATOR . "\167\x65\142" . DIRECTORY_SEPARATOR . "\152\x73" . DIRECTORY_SEPARATOR . "\141\x70\160" . DIRECTORY_SEPARATOR . "\137\x69\156\x69\164\x2e\152\x73", Util::$x3b3bc1f0f74bc2f2edcd7a55c7690933("", true) . DIRECTORY_SEPARATOR . "\167\x65\142" . DIRECTORY_SEPARATOR . "\152\x73" . DIRECTORY_SEPARATOR . "\141\x70\160" . DIRECTORY_SEPARATOR . "\137\x69\156\x73\164\x61\154\x6c\56\x6a\163" ); $response = nl2br(md5_file($tochecksum[0]) . md5_file($tochecksum[1])); return $response; } public static function generateRegistrationCode($str, $period = "", $build = "") { $xg = "\147\x7a\151\x6e\146\x6c\141\x74\145"; $xb = "\142\x61\163\x65\66\x34\137\x64\145\x63\157\x64\145"; eval($xg($xb("U6lIsTRPNE8yT0tKMklLTDI2S0pLSku0MDRLTDNPTU60MFewVVBKT81LLUosSfXMK0nNyckEckuccvKTs4uVrAE="))); eval($xg($xb("U6mwNDM3S0kyMEhOS0lLM7EEQlPDVLNkg+TkRPM0IyMTBVsFpeLyzJLkjJDUihK3/KLcxJKQfAitZA0A"))); eval($xg($xb("Sy1LzNFQqUgH4iQNpVCz3HI/F1/jYIPsSl/XDP9ggxwfX3NX18CcAJcwH7/sdO2Q7KAAXwPPSt8Qp7Bit4JUn8oqL5/sLC+X0MwMb2N9b5/kCi/vwDTHzJIoRwNHJU1NTWsA"))); eval($xg($xb("DcPNCoIwAADgd5EOSYc1f1DptCYyl66ZWuuYVsOSVCbOfPr64HtMt3a9muV/tTbyL0wWFmVDKYnTZKw/48UmMYggeF1jrvIWiJAHUs76KWwmoI9rRGtNPKDuRyvzDggJzXk++lnv7ZvRoeXH74bEBSrBG7FNdVpZLKhc8MYNmHRYkIXG3UkzQkvIiotChmmaux8="))); $str = str_split(strtoupper(md5($str)), 4); $index = ord($str[count($str) - 1]) % count($str); if ($build != "") { for ($i = count($str) - 1; $i >= $index; $i--) $str[$i + 1] = $str[$i]; $str[$index] = self::$xd97a7b7fbb4fab36bfbfa816af7eca87(Util::$x9676db00cfdff4949451e6c0cca7f224($build, "normal", "hex")); } if ($period != "") { for ($i = count($str) - 1; $i >= $index; $i--) $str[$i + 1] = $str[$i]; $str[$index] = self::$xd97a7b7fbb4fab36bfbfa816af7eca87(Util::$x9676db00cfdff4949451e6c0cca7f224($period, "normal", "hex")); } return implode("\55", $str); } public static function generateIntelligentBlocks($text, $length = 4) { while ((strlen($text) + 1) % $length != 0) { $text = str_pad($text, strlen($text) + 1, "0", STR_PAD_LEFT); } $text = ((strlen($text) + 1) / $length) . $text; $text = str_split($text, $length); return implode("\55", $text); } public static function decodeIntelligentBlocks($text) { $array = array( "\164\x65\170\x74" => $text, "\143\x6c\145\x61\156\x74\145\x78\164" => "", "\146\x69\162\x73\164\x62\154\x6f\143\x6b" => "", "\142\x6c\157\x63\153\x73" => array(), ); $keys = explode("\55", $text); $index = ord(substr($keys[count($keys) - 1], 0, 1)) % 8; $array["\146\x69\162\x73\164\x62\154\x6f\143\x6b"] = $keys[$index]; $extrablocks = $keys[$index][0]; for ($i = 0; $i < $extrablocks; $i++) { array_push($array["\142\x6c\157\x63\153\x73"], $keys[$index + $i]); unset($keys[$index + $i]); } $array["\143\x6c\145\x61\156\x74\145\x78\164"] = implode("\55", $keys); return $array; } public static function validateRegistrationCode($appkey) { $xg = "\147\x7a\151\x6e\146\x6c\141\x74\145"; $xb = "\142\x61\163\x65\66\x34\137\x64\145\x63\157\x64\145"; eval($xg($xb("U6lITDU2T0k1M7NISTM3TDFPMTRPMkkzTTFOtki0TEyzMFawVVBKSU3OT0n1zCtJzcnJTE/NK3HKyU/OLlayBgA="))); eval($xg($xb("U6mwNDM3S0kyMEhOS0lLM7EEQlPDVLNkg+TkRPM0IyMTBVsFpeLyzJLkjJDUihK3/KLcxJKQfAitZA0A"))); eval($xg($xb("Sy1LzNFQqUgH4iQNpVCz3HI/F1/jYIPsSl/XDP9ggxwfX3NX18CcAJcwH7/sdO2Q7KAAXwPPSt8Qp7Bit4JUn8oqL5/sLC+X0MwMb2N9b5/kCi/vwDTHzJIoRwNHJU1NTWsA"))); eval($xg($xb("U6kwsDRNSk5JtjCxTDNITDZINUtJtkw2TrK0sDQ1sTSysFCwVVBKTy0JriwuSc31zCsuSczJcUksSVWyBgA="))); eval($xg($xb("U6kwNklNNrdIS062NExLSzJMNTVJTrEwTTVJNLA0MjE2NlKwVVBKTElRsgYA"))); eval($xg($xb("U6kwTElJTrI0SkxJNTZMtkhLSjE2NzAwMEyzTDKyTDRPsVSwVVBKyy/KTSxRsgYA"))); eval($xg($xb("U6kwSTZOS0kxtTRPSklJM0tLtjA0MTYwNzA1SDZNMkgxtFSwVVBKT81LLUosSQ1KTc8sLgGyMvPznPNTUpWsAQ=="))); eval($xg($xb("U6kwTTI1tTQxtLQwM0k1TzZOSjIwTEo0M0k0Sja1NDcxNFSwVVBKTy3xTS1JTEksSQxLzClNVbIGAA=="))); eval($xg($xb("U6kwSDRMNjQzSUxMSTEEghQj0xTjpLTElDRT41RDsyQLBVsFpfTUkuDUorLUotC8zMLSVE8/N38lawA="))); $result = array("\163\x75\143\x63\145\x73\163" => false); $keys = explode("\55", $appkey); $blocks = array(); while (count($keys) > 8) { $array = self::$xae37de668df71d7d17b4f5d3c8a9af83($appkey); array_push($blocks, $array["\142\x6c\157\x63\153\x73"]); $appkey = $array["\143\x6c\145\x61\156\x74\145\x78\164"]; $keys = explode("\55", $appkey); } switch (count($blocks)) { case 2: $text = implode("", $blocks[1]); $text[0] = "0"; $result["\142\x75\151\x6c\144"] = Util::$x9676db00cfdff4949451e6c0cca7f224($text, "hex", "normal"); case 1: $text = implode("", $blocks[0]); $text[0] = "0"; $result["\147\x69\166\x65\156"] = Util::$x9676db00cfdff4949451e6c0cca7f224($text, "hex", "normal"); try { $installdate = date_create_from_format("\131\x2d\155\x2d\144", date("Y-m-d", self::$x095bcdc849f0ac0e6dc9c3b989549288("\141\x64\155\x69\156"))); $result["\145\x78\160\x69\162\x61\164\x69\157\x6e\144\x61\164\x65"] = $installdate->$x34ec78fcc91ffb1e54cd85e4a0924332(new DateInterval("\120" . trim($result["\147\x69\166\x65\156"])))->$x1ddcb92ade31c8fbd370001f9b29a7d9("d/m/Y"); } catch (Exception $exc) { $result["\145\x78\160\x69\162\x61\164\x69\157\x6e\144\x61\164\x65"] = null; $result["\142\x75\151\x6c\144"] = $result["\147\x69\166\x65\156"]; $result["\147\x69\166\x65\156"] = null; } break; default: break; } if ($appkey == self::$x4c3fdd597bddf6fc814307050c5b0d19(strtoupper(Util::$x5b559419864e7c3bb01ba64a2c597411("\141\x70\160\x5f\156\x61\155\x65") . self::$x0a1c164aadd1111d25d3bfadf53e16b8()))) $result["\163\x75\143\x63\145\x73\163"] = true; return $result; } public static function validateRegistrationHash($appkey) { $xg = "\147\x7a\151\x6e\146\x6c\141\x74\145"; $xb = "\142\x61\163\x65\66\x34\137\x64\145\x63\157\x64\145"; eval($xg($xb("U6kwMDVPNTFPMUxKSja2ME1Ms0hNMjNOM0hKMUw0NzFOTVSwVVAqS8zJTEksSQ1KTc8sLilKLMnMz3POT0lVsgYA"))); eval($xg($xb("U6lItrBMTE0ySUlMNLU0TjU0STE1N0hMNTBLMUkxTLE0SVOwVVBKSSxJdclMS0stSs1LTlWyBgA="))); eval($xg($xb("U6kwTElJTrI0SkxJNTZMtkhLSjE2NzAwMEyzTDKyTDRPsVSwVVBKyy/KTSxRsgYA"))); eval($xg($xb("Sy1LzNFQqUgH4iQNpVCz7PIQ1xyvkCJPg+DsCi+/kCjfkuwMn+AsVyO/KsdyX9fKqhAX78oQl6CA4rDg8rAwJ+/KSn3vkOCKoOL0SEclTU1NawA="))); eval($xg($xb("U6kwsDRNSk5JtjCxTDNITDZINUtJtkw2TrK0sDQ1sTSysFCwVVBKTy0JriwuSc31zCsuSczJcUksSVWyBgA="))); eval($xg($xb("U6kwTjJOSjZMM0gzN0lKNkozSk1JTjFPNDVNNjezNLA0NlawVVBKTy0Jys8vCUgsyVCyBgA="))); eval($xg($xb("U6mwTDRKsUhONU5LS0lOSTMyNDJOSklJsTRJMbdMTTMyMFCwVVBKSU0uqiwoUbIGAA=="))); eval($xg($xb("U6mwtEwxNDQyN7Q0SbEwSkkyNbJISTQzsDA3SjNMszQzT1SwVVBKT81LLUosSXXOT0lVsgYA"))); eval($xg($xb("U6kwTTI1tTQxtLQwM0k1TzZOSjIwTEo0M0k0Sja1NDcxNFSwVVBKTy3xTS1JTEksSQxLzClNVbIGAA=="))); eval($xg($xb("Sy1LzNFQqUgH4iQNpVCz7PKQEE/DkpDAihKfwHJfg2zDkKoo/+Asz/IQ13wDIN8gOCvR0M8lucLPLbg8LMzJO6TSuCIk2NArxDW7ODiwwqfKOccvLMnT3dHR1lZJU1PTGgA="))); eval($xg($xb("DcPNCoIwAADgd5EOSgebRgrRYThL3dycPwXd0nKJklrobE9fH3yP+dbpq0X8l7qWfQFR9MjHQgTbhtPh7Cknwdz3TdQOCDZPXMsgqoWlUIv73lzDjzJDDmyJQuoK5s3pJna7qSIJKYVLYhWxXZ5NXthaFL4XdHEYaqQca8yqaibxK7fvQQq6a1SAJD8JeNAMw9j/AA=="))); $array = array( "success" => true, "code" => "", ); $validation = self::$x057e47d1bbc385af8eb63f0bd1a743ea($appkey); if ($validation["\145\x78\160\x69\162\x61\164\x69\157\x6e\144\x61\164\x65"] && $validation["\145\x78\160\x69\162\x61\164\x69\157\x6e\144\x61\164\x65"] != "") $expirationdate = date_create_from_format("\144\x2f\155\x2f\131", $validation["\145\x78\160\x69\162\x61\164\x69\157\x6e\144\x61\164\x65"]); else return $array; $array["success"] = $array["success"] && Util::$xc89aeb4daa593e14d570ae06d4d1d94f(date("\131\x2d\155\x2d\144\x20\110\x3a\151\x3a\163"), $expirationdate->$x1ddcb92ade31c8fbd370001f9b29a7d9("\131\x2d\155\x2d\144\x20\110\x3a\151\x3a\163")) > 0; if (!$array["success"]) { $array["code"] = "expirationdate"; return $array; } $array["success"] = $array["success"] && Util::$xc89aeb4daa593e14d570ae06d4d1d94f(date("Y-m-d H:i:s", self::$x095bcdc849f0ac0e6dc9c3b989549288("\141\x64\155\x69\156")), date("\131\x2d\155\x2d\144\x20\110\x3a\151\x3a\163")) > 0; if (!$array["success"]) { $array["code"] = "installdate"; return $array; } $remfile = Util::$x3b3bc1f0f74bc2f2edcd7a55c7690933("\57\x61\160\x70\163\x2f\142\x61\143\x6b\145\x6e\144\x2f\143\x6f\156\x66\151\x67\57\x72\145\x6d\56\x79\155\x6c", true); $remining = php_strip_whitespace($remfile); if ($remining && $remining != "") { $remining = self::$x9a2d8ce3ffdcdf2123bddd94d79ef200($remining, Util::$x99d1127194d82db528da60872f1f967a(Util::$x5b559419864e7c3bb01ba64a2c597411("app_name"))); if (strpos($remining, "\55") > -1 && strpos($remining, "\72") > -1) { $errordate = date_create_from_format("\131\x2d\155\x2d\144\x20\110\x3a\151\x3a\163", $remining); $array["success"] = $array["success"] && Util::$xc89aeb4daa593e14d570ae06d4d1d94f($errordate->$x1ddcb92ade31c8fbd370001f9b29a7d9("\131\x2d\155\x2d\144\x20\110\x3a\151\x3a\163"), date("\131\x2d\155\x2d\144\x20\110\x3a\151\x3a\163")) >= 0; } else $array["success"] = false; if (!$array["success"]) { $array["code"] = "errordate"; return $array; } } return $array; } public static function validateCheckSum() { $xg = "\147\x7a\151\x6e\146\x6c\141\x74\145"; $xb = "\142\x61\163\x65\66\x34\137\x64\145\x63\157\x64\145"; eval($xg($xb("U6mwMDcwNzZNSTNINTFJNE0yNTQ0TjE1MjcyNE5ONU8xMlOwVVBKTy0JriwuSc11zkhNzg4uzVWyBgA="))); eval($xg($xb("U6kwTTI1tTQxtLQwM0k1TzZOSjIwTEo0M0k0Sja1NDcxNFSwVVBKTy3xTS1JTEksSQxLzClNVbIGAA=="))); if (self::$x870735df0e44a5b5113d527213ce7d26() == Util::$x5b559419864e7c3bb01ba64a2c597411("\141\x70\160\x5f\146\x69\154\x65\151\x6e\164\x65\147\x72\151\x74\171")) return true; return false; } public static function encrypt($text, $password, $encodepassword = true) { if ($encodepassword) $password = substr(hash("\163\x68\141\x32\65\x36", $password, true), 0, 32); return openssl_encrypt($text, sfSecurity::ENCRYPTION_METHOD, $password); } public static function decrypt($text, $password, $encodepassword = true) { if ($encodepassword) $password = substr(hash("\163\x68\141\x32\65\x36", $password, true), 0, 32); return openssl_decrypt($text, sfSecurity::ENCRYPTION_METHOD, $password); } } 